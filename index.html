<!-- HTML 開頭略過 (doctype, head, style 相同) -->
<body>
  <div id="map"></div>
  <div id="version">版本 2.0.8</div>
  <div id="zoomDisplay">Zoom: -</div>

  <!-- 固定資訊面板 -->
  <div id="infoPanel" style="
    position: absolute;
    top: 10px;
    left: 10px;
    z-index: 1000;
    background: rgba(255, 255, 255, 0.95);
    border-radius: 8px;
    padding: 10px;
    max-width: 250px;
    font-size: 16px;
    box-shadow: 0 0 8px rgba(0,0,0,0.2);
  ">
    <b>標記資訊</b><br>
    <div id="infoContent">點擊標記以查看資訊</div>
  </div>

  <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"></script>
  <script>
    // ...（保持原本 JavaScript 不變，以下只列出改動區）

    class MapApp {
      constructor() {
        // 原本 constructor 內容保持不變...
        this.infoContent = document.getElementById('infoContent');
      }

      // 更新 getPopupContent 為更新 infoPanel
      getPopupContent(marker, data) {
        // 不再使用 popup 內容，這裡只回傳文字
        return `
          <b>${data.name}</b><br>
          時間: ${data.time}<br>
          類型: ${markerColors[data.type] || '原始'}<br>
          備註: ${data.remark}<br>
          ${this.editMode ? `<button onclick="app.deleteMarker('${marker._leaflet_id}')">🗑️ 刪除標記</button>` : ''}
        `;
      }

      showInfoInPanel(marker) {
        const data = marker.data;
        const html = `
          <b>${data.name}</b><br>
          時間: ${data.time}<br>
          類型: ${markerColors[data.type] || '原始'}<br>
          備註: ${data.remark}<br>
          ${this.editMode ? `<button onclick="app.deleteMarker('${marker._leaflet_id}')">🗑️ 刪除標記</button>` : ''}
        `;
        this.infoContent.innerHTML = html;
      }

      addMarker(latlng, data) {
        const marker = L.marker(latlng, {
          draggable: this.editMode,
          icon: this.getCustomIcon(data.type)
        });

        marker.data = data;
        // marker.bindPopup(this.getPopupContent(marker, data)); // 移除 popup 綁定
        marker.on('dragend', () => this.saveMarkers());
        marker.on('click', () => {
          if (this.editMode) {
            this.cycleMarkerColor(marker);
          } else if (this.routeSelecting) {
            if (this.selectedMarkers.includes(marker)) {
              this.selectedMarkers = this.selectedMarkers.filter(m => m !== marker);
              marker.setOpacity(1);
            } else {
              this.selectedMarkers.push(marker);
              marker.setOpacity(0.5);
            }
          } else {
            this.showInfoInPanel(marker);
          }
        });

        this.markers.addLayer(marker);
        this.saveMarkers();
        this.filterMarkersByTypes();
        this.updateMarkerScales();
      }
    }

    const app = new MapApp();
  </script>
</body>
</html>
